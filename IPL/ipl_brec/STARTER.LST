Turbo Assembler	 Version 3.1	    12/03/18 11:57:22	    Page 1
starter.asm



      1					 ;
      2					 ; Extended Operating System Loader (XOSL)
      3					 ; Copyright (c) 1999 by Geurt Vos
      4					 ;
      5					 ; This	code is	distributed under GNU General Public License (GPL)
      6					 ;
      7					 ; The full text of the	license	can be found in	the GPL.TXT file,
      8					 ; or at http://www.gnu.org
      9					 ;
     10
     11					 ;/*
     12					 ; * File  : MAIN.ASM
     13					 ; * Author: Geurt Vos
     14					 ; * Date  : March 1999
     15					 ; *
     16					 ; * Main routine for either FAT IPL
     17					 ; */
     18
     19	    0000					 .model	 tiny
     20							 .386p
     21	    0000					 .data
     22		  =80000100		 LOADERADDR	 equ	 80000100h
     23		  =8000			 LOADERSEG	 equ	 8000h
     24
     25	    0000					 .code
     26							 extrn	 _main:	near
     27
     28							 .startup
1    29						 ORG	 100h
1    30	    0100			 @Startup:
     31	    0100  EB 3C					 jmp	 LoaderStart
     32	    0102  90					 nop
     33
     34	    0103  3B*(??)		 FatBootRec	 db	 59 dup	(?)
     35
     36	    013E			 LoaderStart:
     37					 ;		 nop			 ;need to move code two	bytes, so
     38					 ;		  nop			  ;it can be alligned on xxxx:0100h
     39					 ;0000:7c40:
     40					 ;0000:7c3e:
     41					 ;		 db	 0eah		 ;jmp 07b4:0145
     42					 ;		 dd	 07b00145h
     43	    013E  EA					 db	 0eah		 ;jmp 07b4:0143
     44	    013F  07B00143				 dd	 07b00143h
     45
     46					 ;07b4:0145:
     47					 ;07b4:0143:
     48	    0143  8C C8					 mov	 ax,cs
     49	    0145  8E D8					 mov	 ds,ax
     50	    0147  8E D0					 mov	 ss,ax
     51	    0149  BC FFFE				 mov	 sp,0fffeh
     52
     53
     54	    014C  E8 0000e				 call	 _main
     55
     56
     57	    014F			 RunLoader:
Turbo Assembler	 Version 3.1	    12/03/18 11:57:22	    Page 2
starter.asm



     58	    014F  B8 8000				 mov	 ax,LOADERSEG
     59	    0152  8E D8					 mov	 ds,ax
     60	    0154  8E D0					 mov	 ss,ax
     61	    0156  BC FFFE				 mov	 sp,0fffeh
     62
     63	    0159  EA					 db	 0eah		 ;execute com file
     64	    015A  80000100				 dd	 LOADERADDR
     65
     66							 end
1    67						 END @Startup
Turbo Assembler	 Version 3.1	    12/03/18 11:57:22	    Page 3
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "12/03/18"
??FILENAME			  Text	 "starter "
??TIME				  Text	 "11:57:22"
??VERSION			  Number 030A
@32BIT				  Text	 0
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0F8FH
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 STARTER
@INTERFACE			  Text	 00H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@STARTUP			  Near	 DGROUP:0100
@WORDSIZE			  Text	 2
FATBOOTREC			  Byte	 DGROUP:0103
LOADERADDR			  Number 80000100
LOADERSEG			  Number 8000
LOADERSTART			  Near	 DGROUP:013E
RUNLOADER			  Near	 DGROUP:014F
_MAIN (_main)			  Near	 DGROUP:---- Extern

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
  _TEXT				  16  015E Word	  Public  CODE
